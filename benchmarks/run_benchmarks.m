function run_benchmarks
% do a single pass over the imagenet validation data

gpus = 1 ;
batchSize = 256 ;
useCached = 1 ; % load results from cache if available

importedModels = {
'alexnet-pt-mcn', ...
'vgg11-pt-mcn', ...
'vgg13-pt-mcn', ...
'vgg16-pt-mcn', ...
'vgg19-pt-mcn', ...
'squeezenet1_0-pt-mcn', ...
'squeezenet1_1-pt-mcn', ...
'resnet18-pt-mcn', ...
'resnet34-pt-mcn', ...
'resnet50-pt-mcn', ...
'resnet101-pt-mcn', ...
'resnet152-pt-mcn', ...
'resnext_50_32x4d-pt-mcn', ...
'resnext_101_32x4d-pt-mcn', ...
'resnext_101_64x4d-pt-mcn', ...
'inception_v3-pt-mcn', ...
} ;

for ii = 1:numel(importedModels)
  model = importedModels{ii} ;
  imagenet_eval(model, batchSize, gpus, useCached) ;
end

% -------------------------------------------------------
function imagenet_eval(model, batchSize, gpus, useCached)
% -------------------------------------------------------
[~,info] = cnn_imagenet_pt_mcn('model', model, 'batchSize', ...
               batchSize, 'gpus', gpus, 'continue', useCached) ;
top1 = info.val.top1err * 100 ; top5 = info.val.top5err * 100 ;
fprintf('%s: top-1: %.2f, top-5: %.2f\n', model, top1, top5) ;
